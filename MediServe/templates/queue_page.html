{% extends 'base.html' %}
{% load static %}

{% block title %}Order Queue Status{% endblock %}

{% block content %}

<div style="width: 100%; max-width: 650px; margin: 50px auto; background-color: #FFFFFF; border-radius: 15px; box-shadow: 0 8px 24px rgba(0,0,0,0.08); overflow: hidden; font-family: Arial, sans-serif;">

    {# HEADER #}
    <header style="padding: 20px 30px; background-color: #36489e; color: #FFFFFF; display: flex; align-items: center; gap: 15px;">
        <a href="{% url 'main_menu' %}" style="
            width: 45px; height: 45px; background-color: #FFFFFF; color: #36489e;
            display: flex; justify-content: center; align-items: center;
            border-radius: 50%; text-decoration: none; font-weight: bold;
            transition: transform 0.2s;
        " onmouseover="this.style.transform='scale(1.1)';" onmouseout="this.style.transform='scale(1)';">
            <i class="fas fa-arrow-left"></i>
        </a>
        <h1 style="font-size: 1.8em; font-weight: 700; margin: 0; color: #FFFFFF;">Queue Status</h1>
    </header>

    {# MAIN CONTENT #}
    <main style="padding: 35px 30px; display: flex; flex-direction: column; gap: 25px;">

        {% if current_order %}

            <h2 style="color: #36489e; margin-bottom: 10px;">Your Queue Number</h2>
            <div style="background-color: #36489e; color: #FFFFFF; padding: 25px; border-radius: 15px; margin-bottom: 10px;">
                <h1 style="font-size: 4em; margin: 0;">#{{ current_number }}</h1>
            </div>
            <p style="font-size: 1.1em; color: #777; margin-bottom: 25px;">
                Currently Serving: <strong style="color: #dc3545;">#{{ currently_serving }}</strong>
            </p>

            {# ESTIMATED WAIT TIME & STATUS #}
            <div style="border: 1px solid #E3EBEE; padding: 20px; border-radius: 12px; margin-bottom: 30px; background-color: #f7f9fa;">
                <p style="font-weight: bold; margin: 0; color: #36489e;">Estimated Wait Time</p>
                <strong style="font-size: 1.8em; color: #28a745; display: block; margin-top: 5px;">
                    {{ estimated_wait|default:"20 minutes" }}
                </strong>
                <p style="font-size: 0.9em; color: #777; margin-top: 10px;">
                    Status: <span style="font-weight: bold; color: #36489e;">{{ current_order.status }}</span>
                </p>
            </div>

            {# ORDER ITEMS SUMMARY #}
            <div style="text-align: left; margin-bottom: 30px;">
                <h3 style="margin-bottom: 10px; color: #36489e;">Your Order Items:</h3>
                <ul style="list-style: none; padding: 0; border-radius: 10px; overflow: hidden; border: 1px solid #E3EBEE;">
                    {% for item in current_order.items.all %}
                        <li style="padding: 12px 15px; border-bottom: 1px solid #E3EBEE; display: flex; justify-content: space-between; background-color: #FFFFFF;">
                            <span>{{ item.medicine.name }}</span>
                            <strong>Qty: {{ item.quantity }}</strong>
                        </li>
                    {% endfor %}
                </ul>
            </div>

            {# CANCEL ORDER BUTTON #}
            <button class="btn" style="width: 100%; background-color: #dc3545; color: #FFFFFF; padding: 15px; font-size: 1.1em; border-radius: 10px; cursor: not-allowed; margin-bottom: 15px;">
                <i class="fas fa-ban"></i> Cancel Order
            </button>

            {# RETURN TO MAIN MENU BUTTON #}
            <a href="{% url 'main_menu' %}" class="btn" style="width: 100%; background-color: #5c74e3; color: #FFFFFF; padding: 15px; font-size: 1.1em; border-radius: 10px;">
                <i class="fas fa-home"></i> Return to Main Menu
            </a>

        {% else %}
            <p style="text-align: center; padding: 30px; color: #555;">You do not have an active order in the queue.</p>
            <a href="{% url 'medicine_list' %}" class="btn" style="width: 100%; background-color: #5c74e3; color: #FFFFFF; padding: 15px; font-size: 1.1em; border-radius: 10px;">
                <i class="fas fa-prescription-bottle-alt"></i> Browse Medicines
            </a>
        {% endif %}

    </main>
</div>

{% endblock %}
